language: python
python:
- '3.7'
services:
- docker
addons:
  ssh_known_hosts:
    - secure: ADXLXGP6xqH5fW4pB7hEfz1pfEVS7XHX70XRJoBmDCIrIqglXu9dSAKTG3Y2mzdD3/vMenOStQc91+UtMsVn2/jaY3vG/dAN2PtSNEQH7oa8YfK1+86VBEVqinQiSIB5eWAQ/WQImFcXX/hU6YU3F7DB7FiVU2TKaZHxBts5uHW37BzwaoVZ0O7HFxHT/7f43sYESoaaOAiWQYsM+KP63pNnwMzTXFpiIO1UewYoVCSurGAYcR1n1f6oJhVydZATbBUe6MNtrk2Fzws2A7pJQEDu5qdT0VAeH6D0zD82608SHqdyDRcHqddPktworhsPzB+2UhjMCPFvctzGmx9dVb7JbSsx3hPsx8xzAfDSYoLOBzgutDPHwqiurQpBKXWLrYGuoaFuQuHj76z1oOvoEc+ErJUtBeWyNEfgaOKo/iCd7trxeu4GACoVG4vLMOxOyuyogly+mXMScrRAD5mpj2WXEIwKeOnq+KDOJjgN5iVHj2nq5vHemDm6To5Q2dtjl6X7wnQr6PPE/vl8gEx600Wuwooq1aOtPXowsC+OSx2p5lK1w2nqFu6FoonNF3cqyCAYCZCy3mYGVsxAqRxJSo5uRKKpiebsPyLmO8RYJI3hSUvbs1bECwzhyojlICtQmCYzNgWZ12CDqzRV/jH1gZxsBo1Q0Yfrt+Ius35J5Mg=
install:
- pip install -r requirements.txt
- npm i
- npm run bundle
script:
- "./manage.py test --settings isteam.settings.ci"
after_script:
- cp id_rsa ~/.ssh/
before_deploy:
- openssl aes-256-cbc -K $encrypted_f217180e22ee_key -iv $encrypted_f217180e22ee_iv -in id_rsa.enc -out id_rsa -d
- openssl aes-256-cbc -K $encrypted_f182de71524d_key -iv $encrypted_f182de71524d_iv -in .prod.env.enc -out .prod.env -d
- chmod 777 .prod.env
deploy:
  provider: script
  script: docker-compose up -d
  on:
    branch: master
env:
  global:
  - secure: DjEpJxxp8AZeFhTPdHKZr11e9JWwonvKzOcUc6U3EuSxUD6AsfWHQ+qdS8Wh1xLVU7wUNjar85BghNfOghtpkA1+LERIc/16pQWf25V4KEXfOCyINcgGBcdTd7bgDNvQoDFiSuW63zDLL7FNQkUkxo8ypfFjxmfBJ2Rv75u/WYpinWreF21vJGrNMmu4KBGanijaaYkF+tPq7HXqZZQXQPu3Wt4z7A6s6orHpgZxGO+0P8x62MhER8Dbwbos+fLjY/x3bii1Sh2GZwfQNwiwIraZw/McbtVl1CPr1/6eg2TD2xQ16WSHuaS77BJaZfH7lRezayjVw7CkRJbDFzNRWYHtgTAe4X969tLgLKmg/Mnmv5m69WHlmvek9b4f1w1Me2lXLo+91XGKjwETSHWWLGh/VgwEgIddhClgXdy4hpfzp8Uc3e+0qqysATrpBeoifRlfYYzAi12SohYHaidS3x7iCeqcn3FZYOVoLtYBwp9HD38SYTKzXjW0+2YkVUrMxTnf+pZEz1CqRxoxNXDQeZNkG7m9HYw2kEDyeRCJwSvO1J40rbxRfpekAftFzXFv5imldtdOxHJzdBxRHS1qjINwvNNfrybe7+Nco6eSLmsXAD8FgCp7x6HBT2yHbvLxenBLS/5ZcScrM2EkITp0IEeksKZUArr8ex8wrnOc0JI=
  - secure: CLfBiOtaezykmsP4XBoz1zgR7BNqOTG1PYIPLRb4/NYMu4xPshuhhvaynDwbB4SqHeVaUj1vZ25aWseR9f0phnl7zzIHXyLtBUv8yf7TFOFhNrtR1pIpgycwxHXKaK3or6kbTmD5Arbjr7O6d0vuUJ6JyGwaxY8O94dBCJCWSXCxVXG1vBMzO4a7pWPHFIH13eUueX4VpC9H5vLJuzPi/708+9ZpP9aDloV1FlWrMwMHoDNKiqBe/fu9Db+w4Q6tW6piZgUfJrN96iRaV2PQiPir2B/hjlRo863dxpGqSQbmBOdDw9W2Vp1az1NVQ2byGuI4K7Ni6oUAX2zVNSNbNHHk8bPzsKP8JiYQQPXN82L4c5sRN1lgqbF50K3JqfY85s4Lu4yUz/2/tq2+qqtpqQOORikOjmbQNCIF/D+n8LLMfRduMZwXSk/DjnV5IHnELutv4z/7ExUJcmKJXR8g0HouFh6TlLc1ost5J2rBXiRQZSWdqIy5oz99WFmrBlziiQEVZCEn5XeiD0ksSr5cEYbftsRmTVpQfDc/7Jsk1DBfQ7Rx5KEl1nVwpOROKllLBfbi8KD0iC9JECjrfvezEVvld0dNvNdWoHXMDXOAMdTpbqEBWz4EkwdfxKBc7OAQZ4Tta7ik5y+bT490Nhe5m7uU1XIqbBSoq39+WOE3UrU=
  - secure: iUpvL07ZvzPK++dOQXIrsjAjHdvLNDsMvzkH5kfe8CAPeOGpkT7Fcs7uIJWshRB1tTzJH63ObA8aOBp5W8OZWRIC5QIEUK4Imoxe+mYnYYN3BCyRpgl3w2c7phpQ3NgoIfVmYNyP72xp0NjFyH8BTtTGwFwySU696yc5sWLVLevBFj6BQBofpCj6kkX0PkY9dAkUlFx5cmXbwIrRJ2OPY515aHJyEcKloihT2DNeBcE2Ck5F4A0pghHI+4PObzdEGk1/buqfD7SvWRUoiQnbsarf5rsL1WbY5MT02Fk4176lrcBhHCezkGv4k8bC5RuSJXP6NwyBIknOc2/Lsyt8XT3ZBeq5uUYSuI3E6eOzAcMHmwrBA4LdQVPgN2Buc6ploS7vdf7rWBYnq/emP620JEnXeakEBr4gLZ4LSvQt0VrZ0kt5ATGQSkQ57HCoXBVXqRs88v71ZTurD7yhx9ZOQK1iVYutDImfePRBd1ks+zQ8Mliou4BqEI7rSE5AjB0WXXobqZoVZU6jh8Raf5c8uswBO3YdZTsLbi5YSQZCXhlzyVl2E+0T9MwrVQFiimJXgRAhN1APlyVnn51ITi0TosG2elbS0qQd4Hk8lHtnHCnGR7QCkPYvrmVvPHLFjt3wVakVHkhEy66EyHG2rZzzOBUVUo7duvrTdM+8luUeLVs=
  - secure: XlPiv66OsQ0Z0Gb+0+T0a2kEUr/BkFM8b2bUJEmGzQeDrg6Xf1/cvCEweHsUcH0MqFx1ZVo34XYBoiQPRFkwX4YwBcmWKqC70bGYXhEe3yPlPa1V8BEhDA2QYninmNpdh98jVl0DLGvWGtXFkeU8CrYdV033X0qemQNVUWPCu+AKZAaAitAwbSVh5jrIIv5JHBrDA1n7JXFjG43DMEO+fEAxTfMRKjgZmgeX1dMJcLKPUGC0yDDvtLtFcBf3uBtVB2koS52CYhcp54+QMzrRpxl/oA+HPV8KnFQEKB/oLnzZTs9qZrAZ/76BmTV92XdqW2+uZJh9GvCOxG3pIlV5oTT6C/kPaM0MO4geLqfBHX3lHXk4xwGqkHjHnMJqs77suMangSAMKRg2xgreS2/VZLac7+VdCNeRi3sRtKcaBuzM0lusWSsMXELxu6KkX5XuI46Q5AbhBXBkkHbFQKgk8e/hTZem5O7AwV4FQ1tEwH0wD4EXd0VT7noDrTF5XR7bFUD7FakJXgPGAunZuHWpC75AijFNJw1gm82TOhJQDkDmKfBmwEQKYT3ndt18BC3xYAZ2NPgd3RuuPKGONUAkafNkF8YitthAKTD7Nwa2LdV6lmk1fvXci6AcF5DhfxblzAnv8Zn1eMet3CmJdprDpPQcJS+K0yVs77H3JnKQqDU=
  - secure: IyqpjNnH1PLYImbRETLMGNP5FCGxQDk9CqPajbottvnt67qhdRiPdS1993Sv5+myzgLgZexKp9yVoHo5HbHDSyjt/xVFXyq8nglRm69U2uOi4qihyoxaUkT7bAffcaVqCYiIddwn28lN9k8Uy8WpkPcj/WN7AhizUJ/oSkfVXCUUDlYtm+7Aq91wYakcyLLfoXq6MS8HuGsXhrWzhTN1T3ijdcw77qX5X8gNg1C5lhTevuhL2CDCW0H+jULx7hVmv2WBCSeVNFaEPQorkHf9dpzN/D13RBr+w9yXoLEwWTLXrehFBncPWeqWd+ZWayScYSmZjHLDBKJsqLLjSCgzrCB+t6aUVnLMv2kTuHG6jR+p1ZU4/NU9NX1v7bFQnFNa3gjmBtKwa+4BnldMViWhKokk7ozen6VLhvyWjbr7mHZfCj61d8g09wRT8/zemxHE3J+5g+Hf1yvfoO1NK3yztOqlRjazuADRZWNddQRp2wJpmUA0Q3+ZchXZ/VFxGRMC46DzFjgEal9OT0wvVVCdicI4uXjIlZJzCzZ6JfqkyiVyTrZWQzQeuKjadvbPyJ2G6KWpKC4/gNwP4XKQPuxE2A8puUEmrTYOBywUWOgKKzDw+2e04oDsMAdvbAUJ5L3apwneQU4puUiVyBo3bxiLlhvW2PEn2Rfm95UseDEwsmg=
  - secure: laKFB6hzg+CJupGKYrMrYLuWR7qsFHuCOU7yn0HLKhLwR7p1t6Fmwsyw7KNTDazU2WkMAmvCOTKzuQyEu5Tf9HkUWujAAvSJIqjG09/Y813j+MvemPftB2R6IPOouDGJG0yfn2aLo6a0b6txRomoh6wjIP34jeuxK3zzh+bL0AZLLDxIDIm+LEUjLGCoujShtWZO0V4jAxV/PQmmuc4sv3GL/f17GxML9Ft5lCsfvzDDFDltvR5KismVYB4Hrb6XGbu79BHAD4y8RUdJUF23v6rNisqQP9RZvy/hkLC8wATUBBBAt42eTq1cNIlyJhQSt6uxkLr7S7fgq/+oAn4ESDrVlFfIU7BxW8TEA6xJ/eyO6pU2yLfJ7L2Vt4crlr8Ll59PSH8yT3Xx6voXJDondn4iCl0yRnThbbVRt8DGfhVD6iCUdIzh05/xMcGRKwwnm0afEjmEnUSj8LSSu/156HzWK7tsDRibGHtvQep7GSsOTuD6CBOFwhaiQolh5kV+yiwyfY6Mb+nd3Q87yXr8XYWOre/1XDXDBYkfe0mcw2atU+fBj64mcG95L/4abysX/41B8lCVwW/2IuLLY5/VZ4zOoMRYHpf2Sq+z3TJd7lu3KLioY12qMuqlp8PKfCaEhbaNqWZ/vPF/El2Hww5iUgcgrzftCC/L3E2RnyjfrDI=
  - secure: kkrlWyODRXR/SM47mLspvVuJa2SjMiYgmovaW4viDLvl1dNXihz2L9aOTXPhwgdXGOaB/AHN4jWaOBtO1dyEpSu/Ce922w0jgCmtHAax03vBRzCEQtyQFr7OWdEPS23O28BnW2D92K6PxQa3ruKD5Lwz1VIqofivzIZedr43I9jFHa569MQ1ZoGUVfgawv6LLMu8SjRAe1cWoJN+ocLkGZhaJpPruMn1HKAMPlMFnVzESixa18UhepK2HTKNQ+FEY8c2fTV4BFs9dz8jyCOlUInYadjJ4rTZSutjulmdmwaja2I8VSLSwr+3nBmZZasufuI+yLiz3K4Q5Jy6IHv1a9ofUkQ6nuR+vTjZNWCyjF791PIu5UtCT555gjmYIiszWX6POnL8sTVbTlkPxcWwHyumcs4ooOcUfXlGOLFeA+o9EZZQ87AMSoitnBhMPZ25ORInIzpodc+xwE7nLDH04dKd7/z0MjmC2KYth320U8mD8XSxf8K32gp0VmAKpLux5X4lxuPCLJ84fDaHfH8qw6mOq/XEQnoJ0gXyGhpelQsIpmpvutWVhCSupg4wZvryqmzG4nzmHjagNlv3wyd8LyUdQXsKfL28dLJlDLBO045B/Md99JZFT2Q52YzDAzsCLnCNmHFbMidigUqM/VNLo8UahDoyhhtM8sgcFTOwak0=
  - secure: YWd1mK6J0D5JTjq/7iEOCCwg48Pf/oskumbZ4SewFfasgOhqzq4BDPqAq+hjpAWN0hxR2uowwx94qTT/Yt2Ai9vBBUs2/RL4kqXB1HTfPr2LQVcUd314NFLOZ1iuvbGICySn2MkQeNGLcJLkYA+ySgdnnCg08eBLQNcwjYdc+c7jQxnPIPn29qTIsXESDa2ojEJbkXcRDkkmxGcsly4/CCAdC8Mpdc1yUxuPl1MJmDsLuHgXIFTt3OkyrwGtjuuARx7ZOr1xK5iG9go+uM5zHh2Cxvr8EmzTEapiWyxLYjND9a3pzEKijQRLwKO8Xd9f1Z1NYPl0jRgdH8//Ll4a1tBNkuBXe/uVcmJe7ju15SBWMBrmG2VGrueovDyeexm4CA8Dxosx50SzsnR7rLBtCZSgZlrcC4/92Il5F0z/jmkXzqK/9EKbDVBqh3e01i+YDntd/H4ykgYfc5dQcq8W2fB8iyrYIC2zn4gyIf0SifEgTqB3A/QvlBsEnzf9gl9zFrGNvpbgjX6ESsuCT9kcNw5u5SUa1UZ06tvkOvaoppvGKOvtNETrj4CMZ43S/+tK5ei3DWVyRvzHim4W91a9NBA31lJVdUrfMTh77lzEwKCPHtWOlkszXagQ9DlUV902doz9WFIcG2bvm65c527gE4KkMwRUCIXaMB0e3Gya/6U=
