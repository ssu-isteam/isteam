language: python
python:
  - '3.8'

addons:
  ssh_known_hosts:
    - 101.101.211.206

before_install:
  - pip install poetry

install:
  - poetry install
  - npm i
  - npm run bundle
  - ./manage.py migrate groupware --settings isteam.settings.ci
  - ./manage.py migrate --settings isteam.settings.ci  

script:
  - "./manage.py test --settings isteam.settings.ci"

deploy:
  provider: script
  script: bash scripts/cd/on-travis.sh
  on:
    branch: 'hotfix/deploy'

env:
  global:
    - APP_ENV=development
    - secure: DjEpJxxp8AZeFhTPdHKZr11e9JWwonvKzOcUc6U3EuSxUD6AsfWHQ+qdS8Wh1xLVU7wUNjar85BghNfOghtpkA1+LERIc/16pQWf25V4KEXfOCyINcgGBcdTd7bgDNvQoDFiSuW63zDLL7FNQkUkxo8ypfFjxmfBJ2Rv75u/WYpinWreF21vJGrNMmu4KBGanijaaYkF+tPq7HXqZZQXQPu3Wt4z7A6s6orHpgZxGO+0P8x62MhER8Dbwbos+fLjY/x3bii1Sh2GZwfQNwiwIraZw/McbtVl1CPr1/6eg2TD2xQ16WSHuaS77BJaZfH7lRezayjVw7CkRJbDFzNRWYHtgTAe4X969tLgLKmg/Mnmv5m69WHlmvek9b4f1w1Me2lXLo+91XGKjwETSHWWLGh/VgwEgIddhClgXdy4hpfzp8Uc3e+0qqysATrpBeoifRlfYYzAi12SohYHaidS3x7iCeqcn3FZYOVoLtYBwp9HD38SYTKzXjW0+2YkVUrMxTnf+pZEz1CqRxoxNXDQeZNkG7m9HYw2kEDyeRCJwSvO1J40rbxRfpekAftFzXFv5imldtdOxHJzdBxRHS1qjINwvNNfrybe7+Nco6eSLmsXAD8FgCp7x6HBT2yHbvLxenBLS/5ZcScrM2EkITp0IEeksKZUArr8ex8wrnOc0JI=
    - secure: CLfBiOtaezykmsP4XBoz1zgR7BNqOTG1PYIPLRb4/NYMu4xPshuhhvaynDwbB4SqHeVaUj1vZ25aWseR9f0phnl7zzIHXyLtBUv8yf7TFOFhNrtR1pIpgycwxHXKaK3or6kbTmD5Arbjr7O6d0vuUJ6JyGwaxY8O94dBCJCWSXCxVXG1vBMzO4a7pWPHFIH13eUueX4VpC9H5vLJuzPi/708+9ZpP9aDloV1FlWrMwMHoDNKiqBe/fu9Db+w4Q6tW6piZgUfJrN96iRaV2PQiPir2B/hjlRo863dxpGqSQbmBOdDw9W2Vp1az1NVQ2byGuI4K7Ni6oUAX2zVNSNbNHHk8bPzsKP8JiYQQPXN82L4c5sRN1lgqbF50K3JqfY85s4Lu4yUz/2/tq2+qqtpqQOORikOjmbQNCIF/D+n8LLMfRduMZwXSk/DjnV5IHnELutv4z/7ExUJcmKJXR8g0HouFh6TlLc1ost5J2rBXiRQZSWdqIy5oz99WFmrBlziiQEVZCEn5XeiD0ksSr5cEYbftsRmTVpQfDc/7Jsk1DBfQ7Rx5KEl1nVwpOROKllLBfbi8KD0iC9JECjrfvezEVvld0dNvNdWoHXMDXOAMdTpbqEBWz4EkwdfxKBc7OAQZ4Tta7ik5y+bT490Nhe5m7uU1XIqbBSoq39+WOE3UrU=
    - secure: iUpvL07ZvzPK++dOQXIrsjAjHdvLNDsMvzkH5kfe8CAPeOGpkT7Fcs7uIJWshRB1tTzJH63ObA8aOBp5W8OZWRIC5QIEUK4Imoxe+mYnYYN3BCyRpgl3w2c7phpQ3NgoIfVmYNyP72xp0NjFyH8BTtTGwFwySU696yc5sWLVLevBFj6BQBofpCj6kkX0PkY9dAkUlFx5cmXbwIrRJ2OPY515aHJyEcKloihT2DNeBcE2Ck5F4A0pghHI+4PObzdEGk1/buqfD7SvWRUoiQnbsarf5rsL1WbY5MT02Fk4176lrcBhHCezkGv4k8bC5RuSJXP6NwyBIknOc2/Lsyt8XT3ZBeq5uUYSuI3E6eOzAcMHmwrBA4LdQVPgN2Buc6ploS7vdf7rWBYnq/emP620JEnXeakEBr4gLZ4LSvQt0VrZ0kt5ATGQSkQ57HCoXBVXqRs88v71ZTurD7yhx9ZOQK1iVYutDImfePRBd1ks+zQ8Mliou4BqEI7rSE5AjB0WXXobqZoVZU6jh8Raf5c8uswBO3YdZTsLbi5YSQZCXhlzyVl2E+0T9MwrVQFiimJXgRAhN1APlyVnn51ITi0TosG2elbS0qQd4Hk8lHtnHCnGR7QCkPYvrmVvPHLFjt3wVakVHkhEy66EyHG2rZzzOBUVUo7duvrTdM+8luUeLVs=
    - secure: XlPiv66OsQ0Z0Gb+0+T0a2kEUr/BkFM8b2bUJEmGzQeDrg6Xf1/cvCEweHsUcH0MqFx1ZVo34XYBoiQPRFkwX4YwBcmWKqC70bGYXhEe3yPlPa1V8BEhDA2QYninmNpdh98jVl0DLGvWGtXFkeU8CrYdV033X0qemQNVUWPCu+AKZAaAitAwbSVh5jrIIv5JHBrDA1n7JXFjG43DMEO+fEAxTfMRKjgZmgeX1dMJcLKPUGC0yDDvtLtFcBf3uBtVB2koS52CYhcp54+QMzrRpxl/oA+HPV8KnFQEKB/oLnzZTs9qZrAZ/76BmTV92XdqW2+uZJh9GvCOxG3pIlV5oTT6C/kPaM0MO4geLqfBHX3lHXk4xwGqkHjHnMJqs77suMangSAMKRg2xgreS2/VZLac7+VdCNeRi3sRtKcaBuzM0lusWSsMXELxu6KkX5XuI46Q5AbhBXBkkHbFQKgk8e/hTZem5O7AwV4FQ1tEwH0wD4EXd0VT7noDrTF5XR7bFUD7FakJXgPGAunZuHWpC75AijFNJw1gm82TOhJQDkDmKfBmwEQKYT3ndt18BC3xYAZ2NPgd3RuuPKGONUAkafNkF8YitthAKTD7Nwa2LdV6lmk1fvXci6AcF5DhfxblzAnv8Zn1eMet3CmJdprDpPQcJS+K0yVs77H3JnKQqDU=
    - secure: IyqpjNnH1PLYImbRETLMGNP5FCGxQDk9CqPajbottvnt67qhdRiPdS1993Sv5+myzgLgZexKp9yVoHo5HbHDSyjt/xVFXyq8nglRm69U2uOi4qihyoxaUkT7bAffcaVqCYiIddwn28lN9k8Uy8WpkPcj/WN7AhizUJ/oSkfVXCUUDlYtm+7Aq91wYakcyLLfoXq6MS8HuGsXhrWzhTN1T3ijdcw77qX5X8gNg1C5lhTevuhL2CDCW0H+jULx7hVmv2WBCSeVNFaEPQorkHf9dpzN/D13RBr+w9yXoLEwWTLXrehFBncPWeqWd+ZWayScYSmZjHLDBKJsqLLjSCgzrCB+t6aUVnLMv2kTuHG6jR+p1ZU4/NU9NX1v7bFQnFNa3gjmBtKwa+4BnldMViWhKokk7ozen6VLhvyWjbr7mHZfCj61d8g09wRT8/zemxHE3J+5g+Hf1yvfoO1NK3yztOqlRjazuADRZWNddQRp2wJpmUA0Q3+ZchXZ/VFxGRMC46DzFjgEal9OT0wvVVCdicI4uXjIlZJzCzZ6JfqkyiVyTrZWQzQeuKjadvbPyJ2G6KWpKC4/gNwP4XKQPuxE2A8puUEmrTYOBywUWOgKKzDw+2e04oDsMAdvbAUJ5L3apwneQU4puUiVyBo3bxiLlhvW2PEn2Rfm95UseDEwsmg=
    - secure: laKFB6hzg+CJupGKYrMrYLuWR7qsFHuCOU7yn0HLKhLwR7p1t6Fmwsyw7KNTDazU2WkMAmvCOTKzuQyEu5Tf9HkUWujAAvSJIqjG09/Y813j+MvemPftB2R6IPOouDGJG0yfn2aLo6a0b6txRomoh6wjIP34jeuxK3zzh+bL0AZLLDxIDIm+LEUjLGCoujShtWZO0V4jAxV/PQmmuc4sv3GL/f17GxML9Ft5lCsfvzDDFDltvR5KismVYB4Hrb6XGbu79BHAD4y8RUdJUF23v6rNisqQP9RZvy/hkLC8wATUBBBAt42eTq1cNIlyJhQSt6uxkLr7S7fgq/+oAn4ESDrVlFfIU7BxW8TEA6xJ/eyO6pU2yLfJ7L2Vt4crlr8Ll59PSH8yT3Xx6voXJDondn4iCl0yRnThbbVRt8DGfhVD6iCUdIzh05/xMcGRKwwnm0afEjmEnUSj8LSSu/156HzWK7tsDRibGHtvQep7GSsOTuD6CBOFwhaiQolh5kV+yiwyfY6Mb+nd3Q87yXr8XYWOre/1XDXDBYkfe0mcw2atU+fBj64mcG95L/4abysX/41B8lCVwW/2IuLLY5/VZ4zOoMRYHpf2Sq+z3TJd7lu3KLioY12qMuqlp8PKfCaEhbaNqWZ/vPF/El2Hww5iUgcgrzftCC/L3E2RnyjfrDI=
    - secure: kkrlWyODRXR/SM47mLspvVuJa2SjMiYgmovaW4viDLvl1dNXihz2L9aOTXPhwgdXGOaB/AHN4jWaOBtO1dyEpSu/Ce922w0jgCmtHAax03vBRzCEQtyQFr7OWdEPS23O28BnW2D92K6PxQa3ruKD5Lwz1VIqofivzIZedr43I9jFHa569MQ1ZoGUVfgawv6LLMu8SjRAe1cWoJN+ocLkGZhaJpPruMn1HKAMPlMFnVzESixa18UhepK2HTKNQ+FEY8c2fTV4BFs9dz8jyCOlUInYadjJ4rTZSutjulmdmwaja2I8VSLSwr+3nBmZZasufuI+yLiz3K4Q5Jy6IHv1a9ofUkQ6nuR+vTjZNWCyjF791PIu5UtCT555gjmYIiszWX6POnL8sTVbTlkPxcWwHyumcs4ooOcUfXlGOLFeA+o9EZZQ87AMSoitnBhMPZ25ORInIzpodc+xwE7nLDH04dKd7/z0MjmC2KYth320U8mD8XSxf8K32gp0VmAKpLux5X4lxuPCLJ84fDaHfH8qw6mOq/XEQnoJ0gXyGhpelQsIpmpvutWVhCSupg4wZvryqmzG4nzmHjagNlv3wyd8LyUdQXsKfL28dLJlDLBO045B/Md99JZFT2Q52YzDAzsCLnCNmHFbMidigUqM/VNLo8UahDoyhhtM8sgcFTOwak0=
    - secure: RPFVhgVbXPmL6tJ/162XUIdGZP0Zdi4XxIV+A8Mf4cNp/AHavfXa/one0DtyruOdri5NWk63cuWjIkeeoeMB4327pl8cVg+IhWzGT8sYbmx6LlveNvD6bAmwyGKUBTlFSmt1g5UtP5S8MSfUSmgQJfkS/Pab64a8Mnz0oKwaNUE0ZjTFTsvI/BP2t3ftrRdkejYs6Ray+s3YqUzIwZgOCeRd0wkUeAKgzrkM27A1IMmD/9YZKTR2YqKFnBL1g1H1HNt5U0gjF//k+ynUzbakc1IzBmQLke3zQW2rQGxZTcGyRXaYK6y2Nxg+6HHQx0iovq2dNJ5g8+3mezv5BV1aB5KW9LerqkX/QNW4/ndM9dgbP7ZLofk6nmC1mtTZa4pCPi7w2UYcJ79ulOT8OKUCdVIPM5GiVC4E2kKyaKgtLxy+leap0FADsWVJU6+IyIz1cOdg0m2gghtw7NzW+3JeI/U9QSXeHb0lhOVZEI44H02mCxXjgacXHizyp95JM9y7YLg2Y6QQFcAowsRKXj2MHu08Mx6tfL01yzMYYNIx8PfCfqWS6rX6FyQADJ7w6+a4r6Y71WQU3Hv21k3KcoxoiUe3RhSym5ZKe5rKnlYy2s92Kn7788PmGmP1ttz0N1UF4lMDvipwRaAF27VGvbDeGNAn1Jid99snIM0d2b/s16s=
    - secure: tPBvKkxG/2zqrPVqk0K8GemM7JMwQoyUXnZhV2S2B2GMzszXsnOaaTirFxh4IBFVYMCycu4VcnQ5RWvWfA/2RLlAU15Cuah+E28c42vtpDaQ/5M3m9lzssfd/9UnBWloZSdnU8mwlk8EwfUBMW5bjhag1vOYbqJe65elxsPbGENoL6bPZ4KVjnPvIDTo2IJWnWG7nALNCExnPdZ4fkadXLw6LgsrWuXTWI4pA59w3WmAO9Xgp4xH2I3N3e2MIiABswKRM8KcFtS0Sf766YYzupooBrsAXQhsPcM85VJxyVKUtLVBUXPa/3jeitwpqJfnTS2cUywKVPJW4VeZjjlGR0QJYnYMSw4z19TN8qABLxUSi7JGgj0yUdLyjDbzP70zVtKLDPUbGR5BHQpbfLYKw57lqz+5jRKY7YCDgHgt72LNlXO8kOIGs+GjJVhIftKxtdVhA6BWuxbZN4UrLrJBbA7UWcXoqcOEF4zKZwNi48+AveLX27UkY6vmMF+jEt8z+Ug2R2QFyQ+SYysv6GxQZ277O8NiNDZK7OWHsc/bkvE2J9EtEeYIFLqes3m+PZyGLdXb/2BINV3RdBbXkeB85fHCK4+InGxJCUTiCWHfGxQp+xOCuRRuc/UETLC50K/ztFOOO3fOUELRa5xUlLg0ZrKBJtDLeGeqGkFP81g3bsU=
